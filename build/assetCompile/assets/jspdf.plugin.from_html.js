//# sourceMappingURL=jspdf.plugin.from_html.js.map
/*

jsPDF fromHTML plugin. BETA stage. API subject to change. Needs browser, jQuery
Copyright (c) 2012 2012 Willow Systems Corporation, willow-systems.com
*/
(function(u){function k(a,b,g,f){this.pdf=a;this.x=b;this.y=g;this.settings=f;this.init();return this}function r(a){var b=n[a];if(b)return b;b={"xx-small":9,"x-small":11,small:13,medium:16,large:19,"x-large":23,"xx-large":28,auto:0}[a];if(void 0!==b||(b=parseFloat(a)))return n[a]=b/16;b=a.match(/([\d\.]+)(px)/);return 3===b.length?n[a]=parseFloat(b[1])/16:n[a]=1}function t(a,b,g){var f=a.childNodes,c;c=$(a);a={};for(var d,e=c.css("font-family").split(","),h=e.shift();!d&&h;)d=v[h.trim().toLowerCase()],
h=e.shift();a["font-family"]=d||"times";a["font-style"]=w[c.css("font-style")]||"normal";d=x[c.css("font-weight")]||"normal";"bold"===d&&(a["font-style"]="normal"===a["font-style"]?d:d+a["font-style"]);a["font-size"]=r(c.css("font-size"))||1;a["line-height"]=r(c.css("line-height"))||1;a.display="inline"===c.css("display")?"inline":"block";"block"===a.display&&(a["margin-top"]=r(c.css("margin-top"))||0,a["margin-bottom"]=r(c.css("margin-bottom"))||0,a["padding-top"]=r(c.css("padding-top"))||0,a["padding-bottom"]=
r(c.css("padding-bottom"))||0);if(d="block"===a.display)b.setBlockBoundary(),b.setBlockStyle(a);e=0;for(h=f.length;e<h;e++)if(c=f[e],"object"===typeof c)if(1===c.nodeType&&"SCRIPT"!=c.nodeName){var l=c,s=b,k=g,m=!1,p=void 0,n=void 0,q=k["#"+l.id];if(q)if("function"===typeof q)m=q(l,s);else for(p=0,n=q.length;!m&&p!==n;)m=q[p](l,s),p++;q=k[l.nodeName];if(!m&&q)if("function"===typeof q)m=q(l,s);else for(p=0,n=q.length;!m&&p!==n;)m=q[p](l,s),p++;m||t(c,b,g)}else 3===c.nodeType&&b.addText(c.nodeValue,
a);else"string"===typeof c&&b.addText(c,a);d&&b.setBlockBoundary()}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});String.prototype.trimLeft||(String.prototype.trimLeft=function(){return this.replace(/^\s+/g,"")});String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(/\s+$/g,"")});k.prototype.init=function(){this.paragraph={text:[],style:[]};this.pdf.internal.write("q")};k.prototype.dispose=function(){this.pdf.internal.write("Q");
return{x:this.x,y:this.y}};k.prototype.splitFragmentsIntoLines=function(a,b){for(var g=this.pdf.internal.scaleFactor,f={},c,d,e,h,l,k=[],n=[k],m=0,p=this.settings.width;a.length;)if(h=a.shift(),l=b.shift(),h)if(c=l["font-family"],d=l["font-style"],e=f[c+d],e||(e=this.pdf.internal.getFont(c,d).metadata.Unicode,f[c+d]=e),c={widths:e.widths,kerning:e.kerning,fontSize:12*l["font-size"],textIndent:m},d=this.pdf.getStringUnitWidth(h,c)*c.fontSize/g,m+d>p){h=this.pdf.splitTextToSize(h,p,c);for(k.push([h.shift(),
l]);h.length;)k=[[h.shift(),l]],n.push(k);m=this.pdf.getStringUnitWidth(k[0][0],c)*c.fontSize/g}else k.push([h,l]),m+=d;return n};k.prototype.RenderTextFragment=function(a,b){var g=this.pdf.internal.getFont(b["font-family"],b["font-style"]);this.pdf.internal.write("/"+g.id,(12*b["font-size"]).toFixed(2),"Tf","("+this.pdf.internal.pdfEscape(a)+") Tj")};k.prototype.renderParagraph=function(){for(var a=this.paragraph.text,b=0,g=a.length,f,c=!1,d=!1;!c&&b!==g;)(f=a[b]=a[b].trimLeft())&&(c=!0),b++;for(b=
g-1;g&&!d&&-1!==b;)(f=a[b]=a[b].trimRight())&&(d=!0),b--;c=/\s+$/g;d=!0;for(b=0;b!==g;b++)f=a[b].replace(/\s+/g," "),d&&(f=f.trimLeft()),f&&(d=c.test(f)),a[b]=f;b=this.paragraph.style;f=(g=this.paragraph.blockstyle)||{};this.paragraph={text:[],style:[],blockstyle:{},priorblockstyle:g};if(a.join("").trim()){a=this.splitFragmentsIntoLines(a,b);b=12/this.pdf.internal.scaleFactor;c=(Math.max((g["margin-top"]||0)-(f["margin-bottom"]||0),0)+(g["padding-top"]||0))*b;g=((g["margin-bottom"]||0)+(g["padding-bottom"]||
0))*b;f=this.pdf.internal.write;var e,h;this.y+=c;for(f("q","BT",this.pdf.internal.getCoordinateString(this.x),this.pdf.internal.getVerticalCoordinateString(this.y),"Td");a.length;){c=a.shift();e=d=0;for(h=c.length;e!==h;e++)c[e][0].trim()&&(d=Math.max(d,c[e][1]["line-height"],c[e][1]["font-size"]));f(0,(-12*d).toFixed(2),"Td");e=0;for(h=c.length;e!==h;e++)c[e][0]&&this.RenderTextFragment(c[e][0],c[e][1]);this.y+=d*b}f("ET","Q");this.y+=g}};k.prototype.setBlockBoundary=function(){this.renderParagraph()};
k.prototype.setBlockStyle=function(a){this.paragraph.blockstyle=a};k.prototype.addText=function(a,b){this.paragraph.text.push(a);this.paragraph.style.push(b)};var v={helvetica:"helvetica","sans-serif":"helvetica",serif:"times",times:"times","times new roman":"times",monospace:"courier",courier:"courier"},x={100:"normal",200:"normal",300:"normal",400:"normal",500:"bold",600:"bold",700:"bold",800:"bold",900:"bold",normal:"normal",bold:"bold",bolder:"bold",lighter:"normal"},w={normal:"normal",italic:"italic",
oblique:"italic"},n={normal:1};u.fromHTML=function(a,b,g,f){if("string"===typeof a){var c="jsPDFhtmlText"+Date.now().toString()+(1E3*Math.random()).toFixed(0);$('<div style="position: absolute !important;clip: rect(1px 1px 1px 1px); /* IE6, IE7 */clip: rect(1px, 1px, 1px, 1px);padding:0 !important;border:0 !important;height: 1px !important;width: 1px !important; top:auto;left:-100px;overflow: hidden;"><iframe style="height:1px;width:1px" name="'+c+'" /></div>').appendTo(document.body);a=$(window.frames[c].document.body).html(a)[0]}b=
new k(this,b,g,f);t(a,b,f.elementHandlers);return b.dispose()}})(jsPDF.API);